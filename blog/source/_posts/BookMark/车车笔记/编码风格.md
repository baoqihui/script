# 一、优化方法的串行处理

+ 问题：方法的串行处理，对流的遍历，if，for的嵌套处理。会让代码可读性降低，嵌套成为"子弹头"式代码

+ 原有思路：当程序符合某条件时，向下执行，流式编程，直到单条请求结束
+ 优化思路：当程序不符合某条件，跳出程序；将处理后的结果整合为新流，再用新流处理相关业务逻辑

例：查找符合条件的用户，并为其发送消息

1. 主方法提拆分，单个流遍历拆为：查找符合条件用户-》批量发送消息

![image-20211112142057941](https://img-1256282866.cos.ap-beijing.myqcloud.com/image-20211112142057941.png)

2. 原单消息处理方发法，查找用户并对每个用户发送消息，切逻辑为符合条件继续执行![image-20211112142534224](https://img-1256282866.cos.ap-beijing.myqcloud.com/image-20211112142534224.png)